<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/marked-element/marked-element.html">
<link rel="import" href="holo-common-styles.html">
<link rel="import" href="holo-localize-mixin.html">

<dom-module id="holo-home">
  <template>

    <style include="holo-common-styles">

      :host {
        display: block;
      }

    </style>

    <header>
      <h1>{{localize('home-page-title')}}</h1>
    </header>
    <marked-element>
      <div slot="markdown-html"></div>
      <script type="text/markdown" src$="[[src]]">
        {{localize('loading')}}
      </script>
    </marked-element>
  </template>

  <script>
    class HoloHome extends Holo.LocalizeMixin(Polymer.Element) {
      static get is() {
        return 'holo-home';
      }

      static get properties() {
        return {
          categories: {
            type: Array
          },

          visible: {
            type: Boolean,
            observer: '_visibleChanged'
          },

          language: {
            type: String,
            observer: '_languageChanged'
          },

          src: {
            type: String
          }
        }
      }

      _visibleChanged(visible) {
        if (!visible) {
          return;
        }
        Polymer.RenderStatus.afterNextRender(this, () => {
          this.dispatchEvent(new CustomEvent('change-section', {
            bubbles: true,
            composed: true,
            detail: {
              selectedPage: 'home',
              title: this.localize('introduction')
            }
          }));
        });
      }

      _languageChanged(language) {
        this.src = this.rootPath + 'data/' + language + "/about.md";
      }
    }

    customElements.define(HoloHome.is, HoloHome);

  </script>
</dom-module>
